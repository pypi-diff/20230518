# Comparing `tmp/odoo14_addon_stock_owner_restriction-14.0.1.0.1-py3-none-any.whl.zip` & `tmp/odoo14_addon_stock_owner_restriction-14.0.1.0.2-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,27 +1,27 @@
-Zip file size: 30899 bytes, number of entries: 25
--rw-r--r--  2.0 unx     4471 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/README.rst
--rw-r--r--  2.0 unx      635 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/__init__.py
--rw-r--r--  2.0 unx      727 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/__manifest__.py
--rw-r--r--  2.0 unx     2494 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/i18n/es.po
--rw-r--r--  2.0 unx     3741 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/i18n/stock_owner_restriction.pot
--rw-r--r--  2.0 unx      199 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/models/__init__.py
--rw-r--r--  2.0 unx     1481 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/models/product.py
--rw-r--r--  2.0 unx     1787 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/models/stock_move.py
--rw-r--r--  2.0 unx      337 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/models/stock_picking.py
--rw-r--r--  2.0 unx      564 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/models/stock_picking_type.py
--rw-r--r--  2.0 unx     2226 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/models/stock_quant.py
--rw-r--r--  2.0 unx      266 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/readme/CONFIGURE.rst
--rw-r--r--  2.0 unx      145 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx      187 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx     1139 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/readme/USAGE.rst
--rw-r--r--  2.0 unx     9455 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/static/description/icon.png
--rw-r--r--  2.0 unx    14600 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/static/description/index.html
--rw-r--r--  2.0 unx      108 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/tests/__init__.py
--rw-r--r--  2.0 unx     6037 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/tests/test_stock_owner_restriction.py
--rw-r--r--  2.0 unx      547 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/views/stock_picking_type_views.xml
--rw-r--r--  2.0 unx      709 b- defN 22-May-17 12:07 odoo/addons/stock_owner_restriction/views/stock_picking_views.xml
--rw-r--r--  2.0 unx     5090 b- defN 22-May-17 12:07 odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 22-May-17 12:07 odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 22-May-17 12:07 odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2835 b- defN 22-May-17 12:07 odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/RECORD
-25 files, 59877 bytes uncompressed, 26019 bytes compressed:  56.5%
+Zip file size: 31129 bytes, number of entries: 25
+-rw-r--r--  2.0 unx     4471 b- defN 23-May-17 19:19 odoo/addons/stock_owner_restriction/README.rst
+-rw-r--r--  2.0 unx      635 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/__init__.py
+-rw-r--r--  2.0 unx      727 b- defN 23-May-17 19:19 odoo/addons/stock_owner_restriction/__manifest__.py
+-rw-r--r--  2.0 unx     2494 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/i18n/es.po
+-rw-r--r--  2.0 unx     3967 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/i18n/stock_owner_restriction.pot
+-rw-r--r--  2.0 unx      199 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/models/__init__.py
+-rw-r--r--  2.0 unx     1481 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/models/product.py
+-rw-r--r--  2.0 unx     2362 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/models/stock_move.py
+-rw-r--r--  2.0 unx      337 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/models/stock_picking.py
+-rw-r--r--  2.0 unx      642 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/models/stock_picking_type.py
+-rw-r--r--  2.0 unx     2226 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/models/stock_quant.py
+-rw-r--r--  2.0 unx      266 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/readme/CONFIGURE.rst
+-rw-r--r--  2.0 unx      145 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx      187 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx     1139 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/readme/USAGE.rst
+-rw-r--r--  2.0 unx     9455 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/static/description/icon.png
+-rw-r--r--  2.0 unx    14600 b- defN 23-May-17 19:19 odoo/addons/stock_owner_restriction/static/description/index.html
+-rw-r--r--  2.0 unx      108 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/tests/__init__.py
+-rw-r--r--  2.0 unx     7225 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/tests/test_stock_owner_restriction.py
+-rw-r--r--  2.0 unx      547 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/views/stock_picking_type_views.xml
+-rw-r--r--  2.0 unx      709 b- defN 23-May-17 19:18 odoo/addons/stock_owner_restriction/views/stock_picking_views.xml
+-rw-r--r--  2.0 unx     5090 b- defN 23-May-17 19:19 odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-17 19:19 odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-May-17 19:19 odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2835 b- defN 23-May-17 19:19 odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/RECORD
+25 files, 61944 bytes uncompressed, 26249 bytes compressed:  57.6%
```

## zipnote {}

```diff
@@ -57,20 +57,20 @@
 
 Filename: odoo/addons/stock_owner_restriction/views/stock_picking_type_views.xml
 Comment: 
 
 Filename: odoo/addons/stock_owner_restriction/views/stock_picking_views.xml
 Comment: 
 
-Filename: odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/METADATA
+Filename: odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/METADATA
 Comment: 
 
-Filename: odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/WHEEL
+Filename: odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/WHEEL
 Comment: 
 
-Filename: odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/top_level.txt
+Filename: odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/RECORD
+Filename: odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/stock_owner_restriction/__manifest__.py

```diff
@@ -1,14 +1,14 @@
 # Copyright 2020 Carlos Dauden - Tecnativa
 # Copyright 2020 Sergio Teruel - Tecnativa
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl).
 {
     "name": "Stock Owner Restriction",
     "summary": "Do not reserve quantity with assigned owner",
-    "version": "14.0.1.0.1",
+    "version": "14.0.1.0.2",
     "development_status": "Beta",
     "category": "stock",
     "website": "https://github.com/OCA/stock-logistics-workflow",
     "author": "Tecnativa, Odoo Community Association (OCA)",
     "license": "AGPL-3",
     "installable": True,
     "data": ["views/stock_picking_type_views.xml", "views/stock_picking_views.xml"],
```

## odoo/addons/stock_owner_restriction/i18n/stock_owner_restriction.pot

```diff
@@ -58,14 +58,19 @@
 
 #. module: stock_owner_restriction
 #: model:ir.model.fields.selection,name:stock_owner_restriction.selection__stock_picking_type__owner_restriction__picking_partner
 msgid "Picking partner"
 msgstr ""
 
 #. module: stock_owner_restriction
+#: model:ir.model.fields.selection,name:stock_owner_restriction.selection__stock_picking_type__owner_restriction__partner_or_unassigned
+msgid "Picking partner or unassigned owner"
+msgstr ""
+
+#. module: stock_owner_restriction
 #: model:ir.model,name:stock_owner_restriction.model_product_product
 msgid "Product"
 msgstr ""
 
 #. module: stock_owner_restriction
 #: model:ir.model,name:stock_owner_restriction.model_stock_quant
 msgid "Quants"
```

## odoo/addons/stock_owner_restriction/models/stock_move.py

```diff
@@ -23,14 +23,30 @@
             else:
                 dict_key[move.picking_id.owner_id or move.picking_id.partner_id] |= move
         for owner_id, moves_to_assign in dict_key.items():
             super(
                 StockMove,
                 moves_to_assign.with_context(force_restricted_owner_id=owner_id),
             )._action_assign()
+            if (
+                owner_id
+                and moves_to_assign.picking_type_id.owner_restriction
+                == "partner_or_unassigned"
+                and sum(
+                    [
+                        move.reserved_availability - move.product_uom_qty
+                        for move in moves_to_assign
+                    ]
+                )
+                < 0
+            ):
+                super(
+                    StockMove,
+                    moves_to_assign.with_context(force_restricted_owner_id=False),
+                )._action_assign()
 
     def _update_reserved_quantity(
         self,
         need,
         available_quantity,
         location_id,
         lot_id=None,
```

## odoo/addons/stock_owner_restriction/models/stock_picking_type.py

```diff
@@ -8,11 +8,12 @@
     _inherit = "stock.picking.type"
 
     owner_restriction = fields.Selection(
         [
             ("standard_behavior", "Standard behavior"),
             ("unassigned_owner", "Unassigned owner"),
             ("picking_partner", "Picking partner"),
+            ("partner_or_unassigned", "Picking partner or unassigned owner"),
         ],
         string="Owner restriction",
         default="standard_behavior",
     )
```

## odoo/addons/stock_owner_restriction/tests/test_stock_owner_restriction.py

```diff
@@ -119,14 +119,35 @@
         self.picking_out.do_unreserve()
         self.picking_out.action_assign()
         self.assertEqual(self.picking_out.move_lines.reserved_availability, 500.00)
         self.assertEqual(len(self.picking_out.move_line_ids), 1)
         self.assertTrue(self.picking_out.move_line_ids.mapped("owner_id"))
         self.assertEqual(self.picking_out.state, "assigned")
 
+        # Set restriction options on picking type to get only quants with an
+        # owner assigned.
+        # The picking partner has quants assigned and there ara unassigned quants
+        # so the picking is in assigned state and with 1000 reserved units
+        self.picking_type_out.owner_restriction = "partner_or_unassigned"
+        self.picking_out.do_unreserve()
+        self.picking_out.action_assign()
+        self.assertEqual(self.picking_out.move_lines.reserved_availability, 1000.00)
+        self.assertEqual(len(self.picking_out.move_line_ids), 2)
+        self.assertEqual(self.picking_out.move_line_ids.mapped("owner_id"), self.owner)
+
+        # Set restriction options on picking type to get only quants with an
+        # owner assigned.
+        # The picking partner has not quants assigned but there are unassigned quants
+        # so the picking is in assigned state with 500 reserved units
+        self.picking_out.partner_id = False
+        self.picking_out.do_unreserve()
+        self.picking_out.action_assign()
+        self.assertEqual(self.picking_out.move_lines.reserved_availability, 500.00)
+        self.assertEqual(len(self.picking_out.move_line_ids), 1)
+
     def test_search_qty(self):
         products = self.env["product.product"].search(
             [("id", "=", self.product.id), ("qty_available", ">", 500.00)]
         )
         self.assertFalse(products)
         products = self.env["product.product"].search(
             [("id", "=", self.product.id), ("qty_available", ">", 499.00)]
```

## Comparing `odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/METADATA` & `odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo14-addon-stock-owner-restriction
-Version: 14.0.1.0.1
+Version: 14.0.1.0.2
 Summary: Do not reserve quantity with assigned owner
 Home-page: https://github.com/OCA/stock-logistics-workflow
 Author: Tecnativa, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
```

## Comparing `odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/RECORD` & `odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/RECORD`

 * *Files 14% similar despite different names*

```diff
@@ -1,25 +1,25 @@
 odoo/addons/stock_owner_restriction/README.rst,sha256=DIOWeEI8sCuzVyaVKEPxACNnNarPptDxPc61k_34f6Y,4471
 odoo/addons/stock_owner_restriction/__init__.py,sha256=lAP-74tJHX-EJlksaLRkvyHiDc92EHLwLlh4H7cXyhU,635
-odoo/addons/stock_owner_restriction/__manifest__.py,sha256=wfLxEdGOSkz81a59wcjDXTuovReksjEIvNLERxn0dQQ,727
+odoo/addons/stock_owner_restriction/__manifest__.py,sha256=ti6I-Xu40C04V2vOtIBpBZlNsQXqdAjgFIJ3WOnTR6k,727
 odoo/addons/stock_owner_restriction/i18n/es.po,sha256=iBwPnFICMzPdZkGB8lpHzak6CvOuZm7aAeqr2ZN2AbE,2494
-odoo/addons/stock_owner_restriction/i18n/stock_owner_restriction.pot,sha256=turKM6PzRpdsm_qNyOJgP3ZijdsPJq1WQMRP9QWgUE0,3741
+odoo/addons/stock_owner_restriction/i18n/stock_owner_restriction.pot,sha256=UxjyPJPX_LHSJ5SGcfi94oRMpWBq0SX9MbiVg3duIe8,3967
 odoo/addons/stock_owner_restriction/models/__init__.py,sha256=vP0QK8d6QXqo9mud_LMKsDK1_gjpSk2EIhzuO4GVKPY,199
 odoo/addons/stock_owner_restriction/models/product.py,sha256=Z_6358IoH3MG0dZXHph_F6QD2Qn1zr0DkfhQ29Yi9Gc,1481
-odoo/addons/stock_owner_restriction/models/stock_move.py,sha256=JaquEgCK1IRgN3KlgGiF13Og_rp73gN7NXmwWARB5Fc,1787
+odoo/addons/stock_owner_restriction/models/stock_move.py,sha256=GFEOUZOU9cyjIEHC672YjI1CnMphEIsDBr3ALo-LWzs,2362
 odoo/addons/stock_owner_restriction/models/stock_picking.py,sha256=4dXt2_X4SW62lONjaHHvudiB4oDJ6ch99yA8SEKQw6c,337
-odoo/addons/stock_owner_restriction/models/stock_picking_type.py,sha256=gx7KFzE7DxqHHAeW6OwrD28aerCOxJRJtHu9wWmyTbo,564
+odoo/addons/stock_owner_restriction/models/stock_picking_type.py,sha256=uvv1XagqAz9a5zGa0PhUxxugwscsakMiWEl9SjmY4CU,642
 odoo/addons/stock_owner_restriction/models/stock_quant.py,sha256=6E43-P6QhyIIrqohHc6EatqbVjcQertBZmIh1Hncqtw,2226
 odoo/addons/stock_owner_restriction/readme/CONFIGURE.rst,sha256=agXng-TIJUHORQipJIasJRbv9uw2UqbBq8eLnx3lahY,266
 odoo/addons/stock_owner_restriction/readme/CONTRIBUTORS.rst,sha256=jIQHpgSDVZXurSHt-XqBVB_kntjdX_XrG0T3_5ZYJAk,145
 odoo/addons/stock_owner_restriction/readme/DESCRIPTION.rst,sha256=PlowYl7BMiCiWTzLGx4Uma_81s5yOxSFOzdSNheQulo,187
 odoo/addons/stock_owner_restriction/readme/USAGE.rst,sha256=i9bXi-iEWb7Vqksbeh0y5lbq7bCZQOdoUkgZCALMlN0,1139
 odoo/addons/stock_owner_restriction/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
 odoo/addons/stock_owner_restriction/static/description/index.html,sha256=o5mykWgcCREUmV1fSH9SrxSCJOfPcHSNl_UF0JhZE5c,14600
 odoo/addons/stock_owner_restriction/tests/__init__.py,sha256=EvPnDgoZNnS4Mdb9ziLzlEumnqxJeJPQ3gWrpSpS4JA,108
-odoo/addons/stock_owner_restriction/tests/test_stock_owner_restriction.py,sha256=Zkk6DfAL5-AbN7FbBFxgKjajLPt-DD1NvoYW8KT6wOQ,6037
+odoo/addons/stock_owner_restriction/tests/test_stock_owner_restriction.py,sha256=NA3OBS8XFT-Ertw_ha4wze991Z5wWSSgCU6Hzc4PL54,7225
 odoo/addons/stock_owner_restriction/views/stock_picking_type_views.xml,sha256=Ex7wjoELWrYKCuyuXqJ11f1m3Mml_A4LWznSr73U8tY,547
 odoo/addons/stock_owner_restriction/views/stock_picking_views.xml,sha256=CGhlN6-5jAUicofmyTtvyJdCIjmONtneW2lmjZvHi0k,709
-odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/METADATA,sha256=jUo5Oajf7lpr_cRZapl5QUKuK3Im4Ay8Wm-LCzwS8lE,5090
-odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo14_addon_stock_owner_restriction-14.0.1.0.1.dist-info/RECORD,,
+odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/METADATA,sha256=UT4WmyXj0Btz24JFER5ek9Ns4XPwe7jSIxi5DRpwrw4,5090
+odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo14_addon_stock_owner_restriction-14.0.1.0.2.dist-info/RECORD,,
```

